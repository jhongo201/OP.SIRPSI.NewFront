<label class="title">{{title}}</label>
<mat-tab-group>
    <mat-tab>
        <ng-template mat-tab-label>Registrar individual</ng-template>
        <br />
        <div class="container-fluid">
            <form class="row" #f="ngForm" [formGroup]="this.form">
                <div class="col-md-3 mb-2">
                    <label class="form-label">Tipo de documento <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Seleccione un tipo de documento de identidad"></i></label>
                    <ng-select id="IdTypeDocument" #IdTypeDocument formControlName="IdTypeDocument" [items]="listDocs"
                        bindLabel="nombre" bindValue="id" [(ngModel)]="this.form.value.IdTypeDocument" required>
                    </ng-select>
                    <p class="text-danger mt-1" *ngIf="form.controls.IdTypeDocument.errors?.required">Este
                        campo es obligatorio
                    </p>
                    <!-- <p class="mt-2 text-muted">Id: <span class="fw-bolder">{{this.form.value.TipoDocumento}}</span></p> -->
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Documento <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese el numero de documento"></i></label>
                    <input class="form-control" type="text" #Document placeholder="Documento" formControlName="Document"
                        required />
                    <p class="text-danger mt-1" *ngIf="form.controls.Document.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Nombre <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su nombre o nombres"></i></label>
                    <input class="form-control" type="text" #Names placeholder="Nombre" formControlName="Names"
                        required />
                    <p class="text-danger mt-1" *ngIf="form.controls.Names.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Apellidos <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese sus apellidos"></i></label>
                    <input class="form-control" type="text" #Surnames placeholder="Apellidos" formControlName="Surnames"
                        required />
                    <p class="text-danger mt-1" *ngIf="form.controls.Surnames.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Telefono <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese un telefono celular"></i></label>
                    <input class="form-control mb-4 mb-md-0" prefix="+57 " mask="(000) 000 00 00" [showMaskTyped]="true"
                        #PhoneNumber placeholder="Telefono" formControlName="PhoneNumber" />
                    <p class="text-danger mt-1" *ngIf="form.controls.PhoneNumber.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Telefono alternativo <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese un telefono celular alternativo"></i></label>
                    <input class="form-control mb-4 mb-md-0" prefix="+57 " mask="(000) 000 00 00" [showMaskTyped]="true"
                        #PhoneNumberAux placeholder="Telefono" formControlName="PhoneNumberAux" />
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">País <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Seleccione un país"></i></label>
                    <ng-select id="IdCountry" #IdCountry formControlName="IdCountry" [items]="listPaises"
                        bindLabel="nombre" bindValue="id" [(ngModel)]="this.form.value.IdCountry" required>
                    </ng-select>
                    <p class="text-danger mt-1" *ngIf="form.controls.IdCountry.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3 mb-2">
                    <label class="form-label">Centro de trabajo <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Seleccione un centro de trabajo para el trabajador"></i></label>
                    <ng-select id="IdWorkCenter" #IdWorkCenter formControlName="IdWorkCenter" [items]="listCentrosCosto"
                        bindLabel="nombre" bindValue="id" [(ngModel)]="this.form.value.IdWorkCenter" required>
                    </ng-select>
                    <p class="text-danger mt-1" *ngIf="form.controls.IdWorkCenter.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label">Email <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su correo"></i></label>
                    <input class="form-control" type="text" #Email placeholder="Email" formControlName="Email" />
                    <p class="text-danger mt-1" *ngIf="form.controls.Email.errors?.email">Email no valido
                    </p>
                    <p class="text-danger mt-1" *ngIf="form.controls.Email.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label">Email alternativo <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su correo"></i></label>
                    <input class="form-control" type="text" #EmailAux placeholder="Email" formControlName="EmailAux" />
                    <p class="text-danger mt-1" *ngIf="form.controls.EmailAux.errors?.email">Email no valido
                    </p>
                    <p class="text-danger mt-1" *ngIf="form.controls.EmailAux.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label">Contraseña <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su contraseña actual"></i></label>
                    <div>
                        <input class="form-control" [type]="hide ? 'password' : 'text'" #Password
                            placeholder="Confirmar contraseña" formControlName="Password" required
                            style="width: calc(100% - 40px); float: left; border-radius: 0.25rem 0 0 0.25rem;" />
                        <button mat-icon-button matSuffix (click)="hide= !hide" [attr.aria-label]="'Hide password'"
                            style="float: left; width: 40px; background: #e9ecef; border-radius: none; border-radius: 0px 5px 5px 0px; line-height: 38px; height: auto;"
                            [attr.aria-pressed]="hide">
                            <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                    </div>
                    <p class="text-danger mt-1" *ngIf="form.controls.Password.errors?.required" style="float:left;">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label" style="width: 100%;">Tiene alguna discapacidad <i
                            class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Seleccione una opción"></i></label>
                    <mat-radio-group #HaveDisability formControlName="HaveDisability">
                        <mat-radio-button value="1" style="margin-left: 16px;">Si</mat-radio-button>
                        <mat-radio-button value="0" style="margin-left: 16px;">No</mat-radio-button>
                    </mat-radio-group>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label" style="width: 100%;">
                        Tiene dificultades en las habilidades lecto - escritoras <i class="mdi mdi-information"
                            #tooltip="matTooltip" matTooltip="Seleccione una opción"></i></label>
                    <mat-radio-group #ReadingWritingSkills formControlName="ReadingWritingSkills">
                        <mat-radio-button value="1" style="margin-left: 16px;">Si</mat-radio-button>
                        <mat-radio-button value="0" style="margin-left: 16px;">No</mat-radio-button>
                    </mat-radio-group>
                </div>
                <div class="col-md-4 mb-2">
                    <label class="form-label">Ocupación o profesión <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Seleccione una ocupación o profesión"></i></label>
                    <ng-select id="IdOccupationProfession" #IdOccupationProfession
                        formControlName="IdOccupationProfession" [items]="listOcupacionProfesion" bindLabel="nombre"
                        bindValue="id" [(ngModel)]="this.form.value.IdOccupationProfession" required>
                    </ng-select>
                    <p class="text-danger mt-1" *ngIf="form.controls.IdCountry.errors?.required">Este
                        campo es obligatorio
                    </p>
                </div>
                <div class="col-md-3" style="display:none">
                    <label class="form-label">Rol <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su contraseña actual"></i></label>
                    <ng-select id="IdRol" #IdRol formControlName="IdRol" [items]="listRoles" bindLabel="name"
                        bindValue="id" [(ngModel)]="this.form.value.IdRol" required>
                    </ng-select>
                </div>
                <div class="col-md-3" style="display:none">
                    <label class="form-label">Empresa <i class="mdi mdi-information" #tooltip="matTooltip"
                            matTooltip="Ingrese su contraseña actual"></i></label>
                    <ng-select id="IdCompany" #IdCompany formControlName="IdCompany" [items]="listEmpresas"
                        bindLabel="nombre" bindValue="id" [(ngModel)]="this.form.value.IdCompany">
                    </ng-select>
                </div>
                <div class="col-md-3" style="display:none">
                    <label class="form-label">Estado:</label>
                    <ng-select id="IdEstado" #IdEstado formControlName="IdEstado" [items]="estadosList"
                        bindLabel="nombre" bindValue="id" [(ngModel)]="this.form.value.IdEstado" required>
                    </ng-select>
                </div>
            </form>
            <div style="padding: 20px 0 25px 0;">
                <button (click)="onSave()" type="submit" class="btn btn-primary me-2" [disabled]="this.form.invalid"
                    style="margin-right: 8px;">Registrar</button>
                <button class="btn btn-secondary" type="submit" style="margin-right: 8px;"
                    (click)="cancelarForm();">Cancelar</button>
            </div>
        </div>
    </mat-tab>

    <mat-tab>
        <ng-template mat-tab-label>Registro por carga masiva</ng-template>
        <br />
        <div class="container-fluid">
            <label class="form-label">Por favor utilice el siguiente formato en excel para cargar los trabajadores de
                forma masiva: <i class="mdi mdi-file-excel" (click)="downloadExcel();"></i></label>
            <br />
            <br />
            <div class="col-md-5 mb-3">
                <label class="form-label" for="formFile">Carga un archivo<i class="mdi mdi-information"
                        #tooltip="matTooltip" matTooltip="Ingrese la el archivo con los usuarios a cargar"></i></label>
                <input type="file" (change)="onFileChange($event)" accept=".xlsx" class="form-control" type="file"
                    id="formFile">
            </div>

            <div style="padding: 20px 0 25px 0;">
                <button type="submit" class="btn btn-primary me-2" (click)="convertToJson();"
                    style="margin-right: 8px;">Registrar</button>
                <button class="btn btn-secondary" type="submit" style="margin-right: 8px;"
                    (click)="cancelarForm();">Cancelar</button>
            </div>
        </div>
    </mat-tab>
</mat-tab-group>